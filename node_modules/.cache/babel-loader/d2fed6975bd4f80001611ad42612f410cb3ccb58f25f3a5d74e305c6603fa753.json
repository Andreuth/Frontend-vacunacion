{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lvarg\\\\Desktop\\\\ProyectoWeb\\\\frontend\\\\src\\\\pages\\\\Personas.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState, useContext } from \"react\";\nimport API from \"../api/api\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport PageLayout from \"../components/PageLayout\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Personas() {\n  _s();\n  const {\n    auth\n  } = useContext(AuthContext);\n  const isAdmin = auth.rol === \"admin\";\n  const isMedico = auth.rol === \"medico\";\n  const canEdit = isAdmin || isMedico;\n  const [busqueda, setBusqueda] = useState(\"\");\n  const [personas, setPersonas] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [editando, setEditando] = useState(null);\n  const [form, setForm] = useState({\n    nombres: \"\",\n    apellidos: \"\",\n    numero_documento: \"\",\n    rol: \"\",\n    password: \"\"\n  });\n  const [msg, setMsg] = useState({\n    type: \"\",\n    text: \"\"\n  });\n  const showMsg = (type, text) => {\n    setMsg({\n      type,\n      text\n    });\n    setTimeout(() => setMsg({\n      type: \"\",\n      text: \"\"\n    }), 3500);\n  };\n  const onChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setForm(p => ({\n      ...p,\n      [name]: value\n    }));\n  };\n  const limpiar = () => {\n    setForm({\n      nombres: \"\",\n      apellidos: \"\",\n      numero_documento: \"\",\n      rol: \"\",\n      password: \"\"\n    });\n    setEditando(null);\n  };\n\n  // ✅ Filtro de visibilidad para MEDICO: solo padre e hijo\n  const filtrarVisibles = data => {\n    if (isMedico) {\n      return data.filter(p => p.rol === \"padre\" || p.rol === \"hijo\");\n    }\n    return data;\n  };\n  const cargarPersonas = async () => {\n    setLoading(true);\n    try {\n      const res = await API.get(\"/personas/\");\n      const dataFiltrada = filtrarVisibles(res.data);\n      setPersonas(dataFiltrada);\n    } catch {\n      showMsg(\"danger\", \"No se pudo cargar personas.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    cargarPersonas();\n  }, []);\n  const abrirNuevo = () => {\n    limpiar();\n    setShowModal(true);\n  };\n  const abrirEditar = p => {\n    // ✅ seguridad extra en front (aunque backend debe controlar)\n    if (isMedico && !(p.rol === \"padre\" || p.rol === \"hijo\")) {\n      showMsg(\"warning\", \"No tienes permisos para editar este usuario.\");\n      return;\n    }\n    setEditando(p);\n    setForm({\n      nombres: p.nombres,\n      apellidos: p.apellidos,\n      numero_documento: p.numero_documento,\n      rol: p.rol,\n      password: \"\"\n    });\n    setShowModal(true);\n  };\n  const guardar = async e => {\n    e.preventDefault();\n    try {\n      if (!form.rol) {\n        showMsg(\"warning\", \"Selecciona un rol.\");\n        return;\n      }\n\n      // ✅ Médico solo puede guardar padre/hijo\n      if (isMedico && !(form.rol === \"padre\" || form.rol === \"hijo\")) {\n        showMsg(\"warning\", \"Médico solo puede crear/editar padre o hijo.\");\n        return;\n      }\n      const payload = {\n        nombres: form.nombres,\n        apellidos: form.apellidos,\n        numero_documento: form.numero_documento,\n        rol: form.rol\n      };\n\n      // password solo si NO es hijo\n      if (form.rol !== \"hijo\" && form.password) {\n        payload.password = form.password;\n      }\n      if (editando) {\n        await API.put(`/personas/${editando.id_persona}`, payload);\n        showMsg(\"success\", \"Persona actualizada.\");\n      } else {\n        await API.post(\"/personas/\", payload);\n        showMsg(\"success\", \"Persona creada.\");\n      }\n      setShowModal(false);\n      limpiar();\n      cargarPersonas();\n    } catch (err) {\n      var _err$response, _err$response$data;\n      const detail = err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail;\n      showMsg(\"danger\", detail || \"Error al guardar persona.\");\n    }\n  };\n  const eliminar = async (id, rolPersona) => {\n    if (!window.confirm(\"¿Desactivar esta persona?\")) return;\n\n    // ✅ Médico no puede eliminar admin/medico\n    if (isMedico && !(rolPersona === \"padre\" || rolPersona === \"hijo\")) {\n      showMsg(\"warning\", \"No tienes permisos para eliminar este usuario.\");\n      return;\n    }\n    try {\n      await API.delete(`/personas/${id}`);\n      showMsg(\"success\", \"Persona desactivada.\");\n      cargarPersonas();\n    } catch {\n      showMsg(\"danger\", \"No se pudo desactivar.\");\n    }\n  };\n\n  // roles visibles según usuario\n  const rolesDisponibles = () => {\n    if (isAdmin) return [\"admin\", \"medico\", \"padre\", \"hijo\"];\n    if (isMedico) return [\"padre\", \"hijo\"];\n    return [];\n  };\n  const right = /*#__PURE__*/_jsxDEV(\"span\", {\n    className: \"badge text-bg-primary px-3 py-2\",\n    children: [\"Rol: \", /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"fw-semibold\",\n      children: auth.rol\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 12\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 170,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(PageLayout, {\n    title: \"Personas\",\n    subtitle: \"Gesti\\xF3n de usuarios\",\n    right: right,\n    children: [msg.text && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `alert alert-${msg.type} py-2`,\n      role: \"alert\",\n      children: msg.text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 9\n    }, this), canEdit && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-end mb-3\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-primary\",\n        onClick: abrirNuevo,\n        children: \"+ Nueva persona\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 9\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-muted\",\n      children: \"Cargando...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"table-responsive\",\n      children: [/*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"table table-hover align-middle\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          className: \"table-light\",\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"ID\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Nombres\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Documento\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Rol\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Activo\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                width: 180\n              },\n              children: \"Acciones\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: personas.map(p => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: p.id_persona\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: [p.nombres, \" \", p.apellidos]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: p.numero_documento\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"badge text-bg-secondary\",\n                children: p.rol\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: p.activo ? /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"badge text-bg-success\",\n                children: \"S\\xED\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 219,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"badge text-bg-danger\",\n                children: \"No\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"d-flex gap-2\",\n              children: canEdit ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-sm btn-outline-primary\",\n                  onClick: () => abrirEditar(p),\n                  children: \"Editar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 227,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-sm btn-outline-danger\",\n                  onClick: () => eliminar(p.id_persona, p.rol),\n                  children: \"Eliminar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-muted fst-italic\",\n                children: \"Solo lectura\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 19\n            }, this)]\n          }, p.id_persona, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 11\n      }, this), isMedico && /*#__PURE__*/_jsxDEV(\"small\", {\n        className: \"text-muted d-block\",\n        children: [\"*Como m\\xE9dico solo puedes ver/editar usuarios con rol \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"padre\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 68\n        }, this), \" y \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"hijo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 83\n        }, this), \".\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }, this), showModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal fade show d-block\",\n      tabIndex: \"-1\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-dialog modal-lg\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-content\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: guardar,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"modal-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"modal-title\",\n                children: editando ? \"Editar persona\" : \"Nueva persona\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"btn-close\",\n                onClick: () => setShowModal(false)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"modal-body row g-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: \"Nombres *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 276,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-control\",\n                  name: \"nombres\",\n                  value: form.nombres,\n                  onChange: onChange,\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 277,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: \"Apellidos *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-control\",\n                  name: \"apellidos\",\n                  value: form.apellidos,\n                  onChange: onChange,\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 288,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: \"Documento *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 298,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-control\",\n                  name: \"numero_documento\",\n                  value: form.numero_documento,\n                  onChange: onChange,\n                  required: true,\n                  disabled: !!editando\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: \"Rol *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 310,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  className: \"form-select\",\n                  name: \"rol\",\n                  value: form.rol,\n                  onChange: onChange,\n                  required: true,\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"Seleccione...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 318,\n                    columnNumber: 23\n                  }, this), rolesDisponibles().map(r => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: r,\n                    children: r\n                  }, r, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 320,\n                    columnNumber: 25\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 311,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 309,\n                columnNumber: 19\n              }, this), form.rol !== \"hijo\" && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: editando ? \"Nueva contraseña\" : \"Contraseña *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 330,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"password\",\n                  className: \"form-control\",\n                  name: \"password\",\n                  value: form.password,\n                  onChange: onChange,\n                  required: !editando\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 21\n              }, this), form.rol === \"hijo\" && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-12\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"alert alert-info py-2\",\n                  children: [\"Los usuarios con rol \", /*#__PURE__*/_jsxDEV(\"b\", {\n                    children: \"hijo\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 347,\n                    columnNumber: 46\n                  }, this), \" no tienen contrase\\xF1a ni acceso al sistema.\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"modal-footer\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"btn btn-outline-secondary\",\n                onClick: () => setShowModal(false),\n                children: \"Cancelar\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 354,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-primary\",\n                children: \"Guardar\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 176,\n    columnNumber: 5\n  }, this);\n}\n_s(Personas, \"OOQ8tSAAkTvXqZ+S4NSle1p7bwg=\");\n_c = Personas;\nexport default Personas;\nvar _c;\n$RefreshReg$(_c, \"Personas\");","map":{"version":3,"names":["useEffect","useState","useContext","API","AuthContext","PageLayout","jsxDEV","_jsxDEV","Fragment","_Fragment","Personas","_s","auth","isAdmin","rol","isMedico","canEdit","busqueda","setBusqueda","personas","setPersonas","loading","setLoading","showModal","setShowModal","editando","setEditando","form","setForm","nombres","apellidos","numero_documento","password","msg","setMsg","type","text","showMsg","setTimeout","onChange","e","name","value","target","p","limpiar","filtrarVisibles","data","filter","cargarPersonas","res","get","dataFiltrada","abrirNuevo","abrirEditar","guardar","preventDefault","payload","put","id_persona","post","err","_err$response","_err$response$data","detail","response","eliminar","id","rolPersona","window","confirm","delete","rolesDisponibles","right","className","children","fileName","_jsxFileName","lineNumber","columnNumber","title","subtitle","role","onClick","style","width","map","activo","tabIndex","onSubmit","required","disabled","r","_c","$RefreshReg$"],"sources":["C:/Users/lvarg/Desktop/ProyectoWeb/frontend/src/pages/Personas.js"],"sourcesContent":["import { useEffect, useState, useContext } from \"react\";\r\nimport API from \"../api/api\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport PageLayout from \"../components/PageLayout\";\r\n\r\nfunction Personas() {\r\n  const { auth } = useContext(AuthContext);\r\n\r\n  const isAdmin = auth.rol === \"admin\";\r\n  const isMedico = auth.rol === \"medico\";\r\n\r\n  const canEdit = isAdmin || isMedico;\r\n  const [busqueda, setBusqueda] = useState(\"\");\r\n\r\n\r\n  const [personas, setPersonas] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [editando, setEditando] = useState(null);\r\n\r\n  const [form, setForm] = useState({\r\n    nombres: \"\",\r\n    apellidos: \"\",\r\n    numero_documento: \"\",\r\n    rol: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  const [msg, setMsg] = useState({ type: \"\", text: \"\" });\r\n  const showMsg = (type, text) => {\r\n    setMsg({ type, text });\r\n    setTimeout(() => setMsg({ type: \"\", text: \"\" }), 3500);\r\n  };\r\n\r\n  const onChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setForm((p) => ({ ...p, [name]: value }));\r\n  };\r\n\r\n  const limpiar = () => {\r\n    setForm({\r\n      nombres: \"\",\r\n      apellidos: \"\",\r\n      numero_documento: \"\",\r\n      rol: \"\",\r\n      password: \"\",\r\n    });\r\n    setEditando(null);\r\n  };\r\n\r\n  // ✅ Filtro de visibilidad para MEDICO: solo padre e hijo\r\n  const filtrarVisibles = (data) => {\r\n    if (isMedico) {\r\n      return data.filter((p) => p.rol === \"padre\" || p.rol === \"hijo\");\r\n    }\r\n    return data;\r\n  };\r\n\r\n  const cargarPersonas = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await API.get(\"/personas/\");\r\n      const dataFiltrada = filtrarVisibles(res.data);\r\n      setPersonas(dataFiltrada);\r\n    } catch {\r\n      showMsg(\"danger\", \"No se pudo cargar personas.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    cargarPersonas();\r\n  }, []);\r\n\r\n  const abrirNuevo = () => {\r\n    limpiar();\r\n    setShowModal(true);\r\n  };\r\n\r\n  const abrirEditar = (p) => {\r\n    // ✅ seguridad extra en front (aunque backend debe controlar)\r\n    if (isMedico && !(p.rol === \"padre\" || p.rol === \"hijo\")) {\r\n      showMsg(\"warning\", \"No tienes permisos para editar este usuario.\");\r\n      return;\r\n    }\r\n\r\n    setEditando(p);\r\n    setForm({\r\n      nombres: p.nombres,\r\n      apellidos: p.apellidos,\r\n      numero_documento: p.numero_documento,\r\n      rol: p.rol,\r\n      password: \"\",\r\n    });\r\n    setShowModal(true);\r\n  };\r\n\r\n  const guardar = async (e) => {\r\n    e.preventDefault();\r\n\r\n    try {\r\n      if (!form.rol) {\r\n        showMsg(\"warning\", \"Selecciona un rol.\");\r\n        return;\r\n      }\r\n\r\n      // ✅ Médico solo puede guardar padre/hijo\r\n      if (isMedico && !(form.rol === \"padre\" || form.rol === \"hijo\")) {\r\n        showMsg(\"warning\", \"Médico solo puede crear/editar padre o hijo.\");\r\n        return;\r\n      }\r\n\r\n      const payload = {\r\n        nombres: form.nombres,\r\n        apellidos: form.apellidos,\r\n        numero_documento: form.numero_documento,\r\n        rol: form.rol,\r\n      };\r\n\r\n      // password solo si NO es hijo\r\n      if (form.rol !== \"hijo\" && form.password) {\r\n        payload.password = form.password;\r\n      }\r\n\r\n      if (editando) {\r\n        await API.put(`/personas/${editando.id_persona}`, payload);\r\n        showMsg(\"success\", \"Persona actualizada.\");\r\n      } else {\r\n        await API.post(\"/personas/\", payload);\r\n        showMsg(\"success\", \"Persona creada.\");\r\n      }\r\n\r\n      setShowModal(false);\r\n      limpiar();\r\n      cargarPersonas();\r\n    } catch (err) {\r\n      const detail = err?.response?.data?.detail;\r\n      showMsg(\"danger\", detail || \"Error al guardar persona.\");\r\n    }\r\n  };\r\n\r\n  const eliminar = async (id, rolPersona) => {\r\n    if (!window.confirm(\"¿Desactivar esta persona?\")) return;\r\n\r\n    // ✅ Médico no puede eliminar admin/medico\r\n    if (isMedico && !(rolPersona === \"padre\" || rolPersona === \"hijo\")) {\r\n      showMsg(\"warning\", \"No tienes permisos para eliminar este usuario.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await API.delete(`/personas/${id}`);\r\n      showMsg(\"success\", \"Persona desactivada.\");\r\n      cargarPersonas();\r\n    } catch {\r\n      showMsg(\"danger\", \"No se pudo desactivar.\");\r\n    }\r\n  };\r\n\r\n  // roles visibles según usuario\r\n  const rolesDisponibles = () => {\r\n    if (isAdmin) return [\"admin\", \"medico\", \"padre\", \"hijo\"];\r\n    if (isMedico) return [\"padre\", \"hijo\"];\r\n    return [];\r\n  };\r\n\r\n  const right = (\r\n    <span className=\"badge text-bg-primary px-3 py-2\">\r\n      Rol: <span className=\"fw-semibold\">{auth.rol}</span>\r\n    </span>\r\n  );\r\n\r\n  return (\r\n    <PageLayout title=\"Personas\" subtitle=\"Gestión de usuarios\" right={right}>\r\n      {msg.text && (\r\n        <div className={`alert alert-${msg.type} py-2`} role=\"alert\">\r\n          {msg.text}\r\n        </div>\r\n      )}\r\n\r\n      {canEdit && (\r\n        <div className=\"d-flex justify-content-end mb-3\">\r\n          <button className=\"btn btn-primary\" onClick={abrirNuevo}>\r\n            + Nueva persona\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {loading ? (\r\n        <div className=\"text-muted\">Cargando...</div>\r\n      ) : (\r\n        <div className=\"table-responsive\">\r\n          <table className=\"table table-hover align-middle\">\r\n            <thead className=\"table-light\">\r\n              <tr>\r\n                <th>ID</th>\r\n                <th>Nombres</th>\r\n                <th>Documento</th>\r\n                <th>Rol</th>\r\n                <th>Activo</th>\r\n                <th style={{ width: 180 }}>Acciones</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {personas.map((p) => (\r\n                <tr key={p.id_persona}>\r\n                  <td>{p.id_persona}</td>\r\n                  <td>\r\n                    {p.nombres} {p.apellidos}\r\n                  </td>\r\n                  <td>{p.numero_documento}</td>\r\n                  <td>\r\n                    <span className=\"badge text-bg-secondary\">{p.rol}</span>\r\n                  </td>\r\n                  <td>\r\n                    {p.activo ? (\r\n                      <span className=\"badge text-bg-success\">Sí</span>\r\n                    ) : (\r\n                      <span className=\"badge text-bg-danger\">No</span>\r\n                    )}\r\n                  </td>\r\n                  <td className=\"d-flex gap-2\">\r\n                    {canEdit ? (\r\n                      <>\r\n                        <button\r\n                          className=\"btn btn-sm btn-outline-primary\"\r\n                          onClick={() => abrirEditar(p)}\r\n                        >\r\n                          Editar\r\n                        </button>\r\n                        <button\r\n                          className=\"btn btn-sm btn-outline-danger\"\r\n                          onClick={() => eliminar(p.id_persona, p.rol)}\r\n                        >\r\n                          Eliminar\r\n                        </button>\r\n                      </>\r\n                    ) : (\r\n                      <span className=\"text-muted fst-italic\">Solo lectura</span>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n\r\n          {isMedico && (\r\n            <small className=\"text-muted d-block\">\r\n              *Como médico solo puedes ver/editar usuarios con rol <b>padre</b> y <b>hijo</b>.\r\n            </small>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* MODAL */}\r\n      {showModal && (\r\n        <div className=\"modal fade show d-block\" tabIndex=\"-1\">\r\n          <div className=\"modal-dialog modal-lg\">\r\n            <div className=\"modal-content\">\r\n              <form onSubmit={guardar}>\r\n                <div className=\"modal-header\">\r\n                  <h5 className=\"modal-title\">\r\n                    {editando ? \"Editar persona\" : \"Nueva persona\"}\r\n                  </h5>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn-close\"\r\n                    onClick={() => setShowModal(false)}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"modal-body row g-3\">\r\n                  <div className=\"col-md-6\">\r\n                    <label className=\"form-label\">Nombres *</label>\r\n                    <input\r\n                      className=\"form-control\"\r\n                      name=\"nombres\"\r\n                      value={form.nombres}\r\n                      onChange={onChange}\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"col-md-6\">\r\n                    <label className=\"form-label\">Apellidos *</label>\r\n                    <input\r\n                      className=\"form-control\"\r\n                      name=\"apellidos\"\r\n                      value={form.apellidos}\r\n                      onChange={onChange}\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"col-md-6\">\r\n                    <label className=\"form-label\">Documento *</label>\r\n                    <input\r\n                      className=\"form-control\"\r\n                      name=\"numero_documento\"\r\n                      value={form.numero_documento}\r\n                      onChange={onChange}\r\n                      required\r\n                      disabled={!!editando}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"col-md-6\">\r\n                    <label className=\"form-label\">Rol *</label>\r\n                    <select\r\n                      className=\"form-select\"\r\n                      name=\"rol\"\r\n                      value={form.rol}\r\n                      onChange={onChange}\r\n                      required\r\n                    >\r\n                      <option value=\"\">Seleccione...</option>\r\n                      {rolesDisponibles().map((r) => (\r\n                        <option key={r} value={r}>\r\n                          {r}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n\r\n                  {/* PASSWORD solo si NO es hijo */}\r\n                  {form.rol !== \"hijo\" && (\r\n                    <div className=\"col-md-6\">\r\n                      <label className=\"form-label\">\r\n                        {editando ? \"Nueva contraseña\" : \"Contraseña *\"}\r\n                      </label>\r\n                      <input\r\n                        type=\"password\"\r\n                        className=\"form-control\"\r\n                        name=\"password\"\r\n                        value={form.password}\r\n                        onChange={onChange}\r\n                        required={!editando}\r\n                      />\r\n                    </div>\r\n                  )}\r\n\r\n                  {form.rol === \"hijo\" && (\r\n                    <div className=\"col-12\">\r\n                      <div className=\"alert alert-info py-2\">\r\n                        Los usuarios con rol <b>hijo</b> no tienen contraseña ni acceso al sistema.\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"modal-footer\">\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn btn-outline-secondary\"\r\n                    onClick={() => setShowModal(false)}\r\n                  >\r\n                    Cancelar\r\n                  </button>\r\n                  <button className=\"btn btn-primary\">Guardar</button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </PageLayout>\r\n  );\r\n}\r\n\r\nexport default Personas;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}